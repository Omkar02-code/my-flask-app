<!DOCTYPE html>
<html>

<head>
    <title>Consumer Complaints</title>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

</head>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<!-- <script>
    $(document).ready(function() {
        $('select[name="status"]').select2({
            placeholder: "Select Status",
            allowClear: true
        });
        $('select[name="oht_name"]').select2({
            placeholder: "Select OHT Name",
            allowClear: true
        });
        $('select[name="issue"]').select2({
            placeholder: "Select Issue",
            allowClear: true
        });
    }); -->
<body>
    <h1>Consumer Complaints</h1>
    <a href="{{ url_for('index') }}">Home</a> |
    <a href="{{ url_for('add_complaint') }}">Add Complaint</a> | <a href="{{ url_for('import_complaints') }}">Import from Excel/CSV</a>

    <form method="get" action="{{ url_for('complaints') }}" style="margin-bottom: 12px;">
        <label>
            From:
            <input type="date" name="date_from" value="{{ filters.date_from }}">
        </label>
        <label>
            To:
            <input type="date" name="date_to" value="{{ filters.date_to }}">
        </label>
        <!-- Multi-select for Status -->
        <!-- Multi-select for Status -->
<label>Status:
    <select class="js-multi" name="status" multiple>
      {% for s in statuses %}
        <option value="{{ s }}" {% if s in filters.status %}selected{% endif %}>{{ s }}</option>
      {% endfor %}
    </select>
  </label>
  
  <!-- Multi-select for OHT Name -->
  <label>OHT Name:
    <select class="js-multi" name="oht_name" multiple>
      {% for oht in oht_names %}
        <option value="{{ oht }}" {% if oht in filters.oht_name %}selected{% endif %}>{{ oht }}</option>
      {% endfor %}
    </select>
  </label>
  <label> issue:
    <select class="js-multi" name="issue" multiple>
        {% for issue in issues %}
        <option value="{{ issue }}" {% if issue in filters.issue %}selected{% endif %}>{{ issue }}</option>
        {% endfor %}
        </select>
        </label>
  
        <!-- Multi-select for Issue
         <label>
            Issue:
            <select name="issue" multiple size="5">
                {% for issue in issues %}
                <option value="{{ issue }}" {% if issue in filters.issue %}selected{% endif %}>{{ issue }}</option>
                {% endfor %}
                </select>
                </label> -->
                
            <label>
                <!-- issue:
            <input type="text" name="issue" value="{{ filters.issue }}" placeholder="issue">
            <label> -->
                Search:
                <input type="text" name="q" value="{{ filters.q }}" placeholder="name, details, phone">
            </label>
            <button type="submit">Apply</button>
            <a href="{{ url_for('complaints') }}">Reset</a>
    </form>
    <table border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Customer</th>
                <th>Mobile</th>
                <th>OHT Name</th>
                <th>issue</th>
                <th>Address</th>
                <th>Longitude</th>
                <th>Latitude</th>
                <th>Details</th>
                <th>Status</th>
                <th>Actions</th>

            </tr>
        </thead>
        <tbody>
            {% for c in complaints %}
            <tr>
                <td>{{ c['id'] }}</td>
                <td>{{ c['complaint_date'] }}</td>
                <td>{{ c['customer_name'] }}</td>
                <td>{{ c['consumer_mobile_number'] }}</td>
                <td>{{ c['OHT_name'] }}</td>
                <td>{{ c['issue'] }}</td>
                <td>{{ c['Address'] }}</td>
                <td>{{ c['longitude'] }}</td>
                <td>{{ c['latitude'] }}</td>
                <td>{{ c['complaint_details'] }}</td>
                <td>{{ c['status'] }}</td>
                <td>
                    <a href="{{ url_for('edit_complaint', complaint_id=c['id']) }}">Edit</a>
                    <form method="post" action="{{ url_for('delete_complaint', complaint_id=c['id']) }}"
                        style="display:inline" onsubmit="return confirm('Delete this complaint?');">
                        <button type="submit">Delete</button>
                    </form>
                </td>

            </tr>
            {% endfor %}
        </tbody>
    </table>
    <script>
        $(document).ready(function() {
            $('.js-multi').select2({
                placeholder: "Select options",  // Placeholder text
                allowClear: true,               // Show an X to clear selection
                width: '200px'                  // Adjust width to fit your layout
            });
        });
        </script>
        
</body>

</html>