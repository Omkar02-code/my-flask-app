{% extends "base.html" %}
{% block content %}
  <h2 class="mb-3">Import Preview</h2>

  <p>
    <strong>Total rows:</strong> {{ summary.total_rows }} &nbsp;
    <strong>Valid:</strong> {{ summary.valid_rows }} &nbsp;
    <strong>Invalid:</strong> {{ summary.invalid_rows }}
  </p>

  {% if errors and errors|length > 0 %}
    <div class="alert alert-warning">
      Some rows have issues. Fix your file and re-upload, or continue (invalid rows will not import).
    </div>
    <div class="table-responsive mb-3">
      <table class="table table-bordered table-sm">
        <thead class="table-light">
          <tr><th>Row</th><th>Errors</th></tr>
        </thead>
        <tbody>
          {% for e in errors %}
            <tr>
              <td>{{ e.row_index }}</td>
              <td>{{ ", ".join(e.errors) }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% endif %}

  <form method="post" action="{{ url_for('import_complaints_confirm') }}">
    <button class="btn btn-primary" type="submit">Confirm Import</button>
    <a class="btn btn-secondary" href="{{ url_for('import_complaints') }}">Back</a>
  </form>
{% endblock %}
